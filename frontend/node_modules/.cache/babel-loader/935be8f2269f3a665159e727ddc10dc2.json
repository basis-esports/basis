{"ast":null,"code":"import _regeneratorRuntime from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/user/basis/frontend/src/pages/Auth/SignIn.js\";\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  font-size: \", \";\\n  margin-top: \", \";\\n  color: \", \";\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: 1px;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 100%;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: space-between;\\n  font-size: \", \";\\n  margin-top: \", \";\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\nimport styled from 'styled-components';\nimport { A } from 'components/Text';\nimport { Spacing } from 'components/Layout';\nimport { Error } from 'components/Text';\nimport { InputText, Button } from 'components/Form';\nimport { SIGN_IN } from 'graphql/user';\nimport * as Routes from 'routes';\nvar Root = styled.div(_templateObject(), function (p) {\n  return p.theme.font.size.xxs;\n}, function (p) {\n  return p.theme.spacing.sm;\n});\nvar InputContainer = styled(Spacing)(_templateObject2());\nvar ErrorMessage = styled.div(_templateObject3());\nvar ForgotPassword = styled.div(_templateObject4(), function (p) {\n  return p.theme.font.size.xxs;\n}, function (p) {\n  return p.theme.spacing.xxs;\n}, function (p) {\n  return p.theme.colors.white;\n});\n/**\n * Sign In page\n */\n\nvar SignIn = function SignIn(_ref) {\n  var history = _ref.history,\n      location = _ref.location,\n      refetch = _ref.refetch;\n\n  var _useState = useState({\n    emailOrUsername: '',\n    password: ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      values = _useState2[0],\n      setValues = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useMutation = useMutation(SIGN_IN),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      signin = _useMutation2[0],\n      loading = _useMutation2[1].loading;\n\n  useEffect(function () {\n    setError('');\n  }, [location.pathname]);\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        name = _e$target.name,\n        value = _e$target.value;\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      [name]: value\n    }));\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!(!emailOrUsername || !password)) {\n                _context.next = 4;\n                break;\n              }\n\n              setError('All fields are required');\n              return _context.abrupt(\"return\");\n\n            case 4:\n              setError('');\n              _context.prev = 5;\n              _context.next = 8;\n              return signin({\n                variables: {\n                  input: {\n                    emailOrUsername,\n                    password\n                  }\n                }\n              });\n\n            case 8:\n              response = _context.sent;\n              localStorage.setItem('token', response.data.signin.token);\n              _context.next = 12;\n              return refetch();\n\n            case 12:\n              history.push(Routes.HOME);\n              _context.next = 18;\n              break;\n\n            case 15:\n              _context.prev = 15;\n              _context.t0 = _context[\"catch\"](5);\n              setError(_context.t0.graphQLErrors[0].message);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[5, 15]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var emailOrUsername = values.emailOrUsername,\n      password = values.password;\n  return /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Root, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(InputContainer, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, error && /*#__PURE__*/React.createElement(ErrorMessage, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Error, {\n    size: \"xxs\",\n    color: \"white\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 15\n    }\n  }, error)), /*#__PURE__*/React.createElement(InputText, {\n    autoFocus: true,\n    type: \"text\",\n    name: \"emailOrUsername\",\n    values: emailOrUsername,\n    onChange: handleChange,\n    placeholder: \"Email or Username\",\n    borderColor: \"white\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(InputContainer, {\n    left: \"xs\",\n    right: \"xs\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(InputText, {\n    type: \"password\",\n    name: \"password\",\n    values: password,\n    onChange: handleChange,\n    placeholder: \"Password\",\n    borderColor: \"white\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(A, {\n    to: Routes.FORGOT_PASSWORD,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ForgotPassword, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, \"Forgot password?\"))), /*#__PURE__*/React.createElement(Button, {\n    disabled: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, \"Log in\")));\n};\n\nSignIn.propTypes = {\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired\n};\nexport default withRouter(SignIn);","map":{"version":3,"sources":["/Users/user/basis/frontend/src/pages/Auth/SignIn.js"],"names":["React","useState","useEffect","PropTypes","withRouter","useMutation","styled","A","Spacing","Error","InputText","Button","SIGN_IN","Routes","Root","div","p","theme","font","size","xxs","spacing","sm","InputContainer","ErrorMessage","ForgotPassword","colors","white","SignIn","history","location","refetch","emailOrUsername","password","values","setValues","error","setError","signin","loading","pathname","handleChange","e","target","name","value","handleSubmit","preventDefault","variables","input","response","localStorage","setItem","data","token","push","HOME","graphQLErrors","message","FORGOT_PASSWORD","propTypes","object","isRequired","func"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router-dom';\nimport { useMutation } from '@apollo/client';\nimport styled from 'styled-components';\n\nimport { A } from 'components/Text';\nimport { Spacing } from 'components/Layout';\nimport { Error } from 'components/Text';\nimport { InputText, Button } from 'components/Form';\n\nimport { SIGN_IN } from 'graphql/user';\n\nimport * as Routes from 'routes';\n\nconst Root = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: space-between;\n  font-size: ${(p) => p.theme.font.size.xxs};\n  margin-top: ${(p) => p.theme.spacing.sm};\n`;\n\nconst InputContainer = styled(Spacing)`\n  width: 100%;\n`;\n\nconst ErrorMessage = styled.div`\n  position: absolute;\n  top: 1px;\n`;\n\nconst ForgotPassword = styled.div`\n  font-size: ${(p) => p.theme.font.size.xxs};\n  margin-top: ${(p) => p.theme.spacing.xxs};\n  color: ${(p) => p.theme.colors.white};\n`;\n\n/**\n * Sign In page\n */\nconst SignIn = ({ history, location, refetch }) => {\n  const [values, setValues] = useState({ emailOrUsername: '', password: '' });\n  const [error, setError] = useState('');\n  const [signin, { loading }] = useMutation(SIGN_IN);\n\n  useEffect(() => {\n    setError('');\n  }, [location.pathname]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setValues({ ...values, [name]: value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!emailOrUsername || !password) {\n      setError('All fields are required');\n      return;\n    }\n\n    setError('');\n    try {\n      const response = await signin({\n        variables: { input: { emailOrUsername, password } },\n      });\n      localStorage.setItem('token', response.data.signin.token);\n      await refetch();\n      history.push(Routes.HOME);\n    } catch (error) {\n      setError(error.graphQLErrors[0].message);\n    }\n  };\n\n  const { emailOrUsername, password } = values;\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <Root>\n        <InputContainer>\n          {error && (\n            <ErrorMessage>\n              <Error size=\"xxs\" color=\"white\">\n                {error}\n              </Error>\n            </ErrorMessage>\n          )}\n\n          <InputText\n            autoFocus\n            type=\"text\"\n            name=\"emailOrUsername\"\n            values={emailOrUsername}\n            onChange={handleChange}\n            placeholder=\"Email or Username\"\n            borderColor=\"white\"\n          />\n        </InputContainer>\n\n        <InputContainer left=\"xs\" right=\"xs\">\n          <InputText\n            type=\"password\"\n            name=\"password\"\n            values={password}\n            onChange={handleChange}\n            placeholder=\"Password\"\n            borderColor=\"white\"\n          />\n          <A to={Routes.FORGOT_PASSWORD}>\n            <ForgotPassword>Forgot password?</ForgotPassword>\n          </A>\n        </InputContainer>\n\n        <Button disabled={loading}>Log in</Button>\n      </Root>\n    </form>\n  );\n};\n\nSignIn.propTypes = {\n  history: PropTypes.object.isRequired,\n  refetch: PropTypes.func.isRequired,\n};\n\nexport default withRouter(SignIn);\n"]},"metadata":{},"sourceType":"module"}