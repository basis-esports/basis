{"ast":null,"code":"import _slicedToArray from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/user/basis/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/user/basis/frontend/src/pages/Explore/Explore.js\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-template-columns: repeat(auto-fill, minmax(260px, 3fr));\\n  grid-auto-rows: auto;\\n  grid-gap: 20px;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  margin-top: \", \";\\n  margin-bottom: \", \";\\n\\n  @media (min-width: \", \") {\\n    margin-left: \", \";\\n    padding: 0;\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, Fragment } from 'react';\nimport styled from 'styled-components';\nimport { generatePath } from 'react-router-dom';\nimport { useQuery } from '@apollo/client';\nimport { Container } from 'components/Layout';\nimport ExploreCard from './ExploreCard';\nimport Skeleton from 'components/Skeleton';\nimport PostPopup from 'components/PostPopup';\nimport Modal from 'components/Modal';\nimport InfiniteScroll from 'components/InfiniteScroll';\nimport Empty from 'components/Empty';\nimport { Loading } from 'components/Loading';\nimport Head from 'components/Head';\nimport { GET_POSTS } from 'graphql/post';\nimport { EXPLORE_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\nimport { useStore } from 'store';\nimport * as Routes from 'routes';\nvar Root = styled(Container)(_templateObject(), function (p) {\n  return p.theme.spacing.lg;\n}, function (p) {\n  return p.theme.spacing.sm;\n}, function (p) {\n  return p.theme.screen.lg;\n}, function (p) {\n  return p.theme.spacing.lg;\n});\nvar PostsContainer = styled.div(_templateObject2());\n/**\n * Explore page\n */\n\nvar Explore = function Explore() {\n  var _useStore = useStore(),\n      _useStore2 = _slicedToArray(_useStore, 1),\n      auth = _useStore2[0].auth;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      modalPostId = _useState2[0],\n      setModalPostId = _useState2[1];\n\n  var variables = {\n    authUserId: auth.user.id,\n    skip: 0,\n    limit: EXPLORE_PAGE_POSTS_LIMIT\n  };\n\n  var _useQuery = useQuery(GET_POSTS, {\n    variables\n  }),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      fetchMore = _useQuery.fetchMore,\n      networkStatus = _useQuery.networkStatus;\n\n  var closeModal = function closeModal() {\n    window.history.pushState('', '', '/explore');\n    setModalPostId(null);\n  };\n\n  var openModal = function openModal(postId) {\n    window.history.pushState('', '', generatePath(Routes.POST, {\n      id: postId\n    }));\n    setModalPostId(postId);\n  };\n\n  var renderContent = function renderContent() {\n    if (loading && networkStatus === 1) {\n      return /*#__PURE__*/React.createElement(PostsContainer, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Skeleton, {\n        height: 300,\n        count: EXPLORE_PAGE_POSTS_LIMIT,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }\n      }));\n    }\n\n    var _data$getPosts = data.getPosts,\n        posts = _data$getPosts.posts,\n        count = _data$getPosts.count;\n    if (!posts.length > 0) return /*#__PURE__*/React.createElement(Empty, {\n      text: \"No posts yet.\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 35\n      }\n    });\n    return /*#__PURE__*/React.createElement(InfiniteScroll, {\n      data: posts,\n      dataKey: \"getPosts.posts\",\n      count: parseInt(count),\n      variables: variables,\n      fetchMore: fetchMore,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 7\n      }\n    }, function (data) {\n      var showNextLoading = loading && networkStatus === 3 && count !== data.length;\n      return /*#__PURE__*/React.createElement(Fragment, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(PostsContainer, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 15\n        }\n      }, data.map(function (post) {\n        return /*#__PURE__*/React.createElement(Fragment, {\n          key: post.id,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(Modal, {\n          open: modalPostId === post.id,\n          onClose: closeModal,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(PostPopup, {\n          id: post.id,\n          closeModal: closeModal,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 23\n          }\n        })), /*#__PURE__*/React.createElement(ExploreCard, {\n          image: post.image,\n          countLikes: post.likes.length,\n          countComments: post.comments.length,\n          openPostPopup: function openPostPopup() {\n            return openModal(post.id);\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 21\n          }\n        }));\n      })), showNextLoading && /*#__PURE__*/React.createElement(Loading, {\n        top: \"lg\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 35\n        }\n      }));\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(Root, {\n    maxWidth: \"md\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Head, {\n    title: \"Explore New Posts and Users\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }\n  }), renderContent());\n};\n\nexport default Explore;","map":{"version":3,"sources":["/Users/user/basis/frontend/src/pages/Explore/Explore.js"],"names":["React","useState","Fragment","styled","generatePath","useQuery","Container","ExploreCard","Skeleton","PostPopup","Modal","InfiniteScroll","Empty","Loading","Head","GET_POSTS","EXPLORE_PAGE_POSTS_LIMIT","useStore","Routes","Root","p","theme","spacing","lg","sm","screen","PostsContainer","div","Explore","auth","modalPostId","setModalPostId","variables","authUserId","user","id","skip","limit","data","loading","fetchMore","networkStatus","closeModal","window","history","pushState","openModal","postId","POST","renderContent","getPosts","posts","count","length","parseInt","showNextLoading","map","post","image","likes","comments"],"mappings":"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","sourcesContent":["import React, { useState, Fragment } from 'react';\nimport styled from 'styled-components';\nimport { generatePath } from 'react-router-dom';\nimport { useQuery } from '@apollo/client';\n\nimport { Container } from 'components/Layout';\nimport ExploreCard from './ExploreCard';\nimport Skeleton from 'components/Skeleton';\nimport PostPopup from 'components/PostPopup';\nimport Modal from 'components/Modal';\nimport InfiniteScroll from 'components/InfiniteScroll';\nimport Empty from 'components/Empty';\nimport { Loading } from 'components/Loading';\nimport Head from 'components/Head';\n\nimport { GET_POSTS } from 'graphql/post';\n\nimport { EXPLORE_PAGE_POSTS_LIMIT } from 'constants/DataLimit';\n\nimport { useStore } from 'store';\n\nimport * as Routes from 'routes';\n\nconst Root = styled(Container)`\n  margin-top: ${(p) => p.theme.spacing.lg};\n  margin-bottom: ${(p) => p.theme.spacing.sm};\n\n  @media (min-width: ${(p) => p.theme.screen.lg}) {\n    margin-left: ${(p) => p.theme.spacing.lg};\n    padding: 0;\n  }\n`;\n\nconst PostsContainer = styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(260px, 3fr));\n  grid-auto-rows: auto;\n  grid-gap: 20px;\n`;\n\n/**\n * Explore page\n */\nconst Explore = () => {\n  const [{ auth }] = useStore();\n  const [modalPostId, setModalPostId] = useState(null);\n  const variables = {\n    authUserId: auth.user.id,\n    skip: 0,\n    limit: EXPLORE_PAGE_POSTS_LIMIT,\n  };\n  const { data, loading, fetchMore, networkStatus } = useQuery(GET_POSTS, {\n    variables,\n  });\n\n  const closeModal = () => {\n    window.history.pushState('', '', '/explore');\n    setModalPostId(null);\n  };\n\n  const openModal = (postId) => {\n    window.history.pushState('', '', generatePath(Routes.POST, { id: postId }));\n    setModalPostId(postId);\n  };\n\n  const renderContent = () => {\n    if (loading && networkStatus === 1) {\n      return (\n        <PostsContainer>\n          <Skeleton height={300} count={EXPLORE_PAGE_POSTS_LIMIT} />\n        </PostsContainer>\n      );\n    }\n\n    const { posts, count } = data.getPosts;\n    if (!posts.length > 0) return <Empty text=\"No posts yet.\" />;\n\n    return (\n      <InfiniteScroll\n        data={posts}\n        dataKey=\"getPosts.posts\"\n        count={parseInt(count)}\n        variables={variables}\n        fetchMore={fetchMore}\n      >\n        {(data) => {\n          const showNextLoading = loading && networkStatus === 3 && count !== data.length;\n\n          return (\n            <Fragment>\n              <PostsContainer>\n                {data.map((post) => (\n                  <Fragment key={post.id}>\n                    <Modal open={modalPostId === post.id} onClose={closeModal}>\n                      <PostPopup id={post.id} closeModal={closeModal} />\n                    </Modal>\n\n                    <ExploreCard\n                      image={post.image}\n                      countLikes={post.likes.length}\n                      countComments={post.comments.length}\n                      openPostPopup={() => openModal(post.id)}\n                    />\n                  </Fragment>\n                ))}\n              </PostsContainer>\n\n              {showNextLoading && <Loading top=\"lg\" />}\n            </Fragment>\n          );\n        }}\n      </InfiniteScroll>\n    );\n  };\n\n  return (\n    <Root maxWidth=\"md\">\n      <Head title=\"Explore New Posts and Users\" />\n\n      {renderContent()}\n    </Root>\n  );\n};\n\nexport default Explore;\n"]},"metadata":{},"sourceType":"module"}